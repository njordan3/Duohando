<html>
    <head>
        <meta charset="utf-8"/>
        <title>Duohando Dashboard</title>
        <link rel="shortcut icon" type="image/x-icon" href="https://duohando.com/favicon.ico">
    </head>
    <body>
        <form action="/logout", method="GET">
            <div>
                <button>Logout</button>
            </div>
        </form>
        <% if (locals.qrcode !== undefined && locals.token !== undefined) { %>
            <br>
            <p>Install one of the listed apps and capture the QR code or manually type the token</p>
            <img src=<%= qrcode %>>
            <p>Token: <%= token %></p>
            <form action="/activate2FA", method="POST">
                <div>
                    <label for="token">Code</label>
                    <input name="token" type="text"/>
                </div>
                <div>
                    <button>Submit Code</button>
                </div>
            </form>
        <% } else { %>
            <form action="/showActivate2FAForm" method="GET" >
                <div>
                    <button>Activate 2-Factor Authentication</button>
                </div>
                <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en_US&gl=US">Android</a>
                <a href="https://apps.apple.com/us/app/google-authenticator/id388497605">iPhone</a>
                <a href="https://authenticator.cc/">Web Browser Extension</a>
            </form>
        <% } %>
        <div style="border-style: solid; border-width: 1px; padding: 10px">
            <div>
                <p>Only for email/password accounts</p>
            </div>
            <form action="/changePassword" method="POST">
                <div>
                    <label for="password_new">New Password</label>
                    <input name="password_new" type="password" required="required" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[-+_!@#$%^&*.,?]).{8,}"/>
                </div>
                <div>
                    <button>Change Password</button>
                </div>
            </form>
            <form action="/changeEmail" method="POST">
                <div>
                    <label for="email_new">New Email</label>
                    <input name="email_new" type="email" required="required" pattern="(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*)@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])"/>
                </div>
                <div>
                    <button>Change Email</button>
                </div>
            </form>
        </div>
        <div style="border-style: solid; border-width: 1px; padding: 10px">
            <div>
                <p>Only for email/password and Facebook accounts</p>
            </div>
            <form action="/changeToGoogle" method="GET">
                <div>
                    <button>Change to Google Account</button>
                </div>
            </form>
        </div>
        <div style="border-style: solid; border-width: 1px; padding: 10px">
            <div>
                <p>Only for email/password and Google accounts</p>
            </div>
            <form action="/changeToFacebook" method="GET">
                <div>
                    <button>Change to Facebook Account</button>
                </div>
            </form>
        </div>
        <form action="/changeToEmail" method="POST" style="border-style: solid; border-width: 1px; padding: 10px">
            <div>
                <p>Only for external Google/Facebook accounts</p>
            </div>
            <div>
                <label for="email">Email</label>
                <input name="email" type="email" required="required" pattern="(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*)@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])"/>
            </div>
            <div>
                <label for="password">Password</label>
                <!--At least 8 characters with at least 1: number, letter, and symbol-->
                <input name="password" type="password" required="required" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[-+_!@#$%^&*.,?]).{8,}"/>
            </div>
            <div>
                <button>Change to Email Account</button>
            </div>
        </form>
        <% if (locals.toggle2FAForm !== undefined && locals.action !== undefined) { %>
            <br>
            <p>Check for your one time password in Google Authenticator</p>
            <form action=<%= action %> method="POST">
                <div>
                    <label for="token">Code</label>
                    <input name="token" type="text"/>
                </div>
                <div>
                    <button>Submit Code</button>
                </div>
            </form>
        <% } %>
    </body>
    <script src="/dashboard/index.js"></script>
</html>