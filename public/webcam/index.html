<!DOCTYPE html>
<html>
    <body>
        <head>
            <meta charset="utf-8"/>
            <title>Duohando</title>
            <link rel="shortcut icon" type="image/x-icon" href="https://duohando.com/favicon.ico">
        </head>
        <body>
            <video autoplay playsinline muted id = "webcamView" width = "224" height="224"></video>
            <h2>Webcam</h2>
<!--           <script src = "../server/webcam.js"></script>-->
        <script>
            // Boolean to check whether the camera the API is supported
            function getUserMediaSupported() {
                return !!(navigator.mediaDevices &&
                         navigator.mediaDevices.getUserMedia);
            }
            // Checking whether the browser supported getUserMedia()
            if (getUserMediaSupported()) {
                console.log("getUserMedia is supported by your browser");
            } else {
                console.warn("getUserMedia is not supported by your browser")
            }
            // Asynchronous function the set up the web cam for the web page
        async function setupWebcam() {
            return new Promise( ( resolve, reject ) => {
                const webcamElem = document.getElementById( "webcamView" );
                const navigatorAny = navigator;
                navigator.getUserMedia = navigator.getUserMedia ||
                navigatorAny.webkitGetUserMedia || navigatorAny.mozGetUserMedia ||
                navigatorAny.msGetUserMedia;
                if( navigator.getUserMedia ) {
                    navigator.getUserMedia( { video: true },
                        stream => {
                            webcamElem.srcObject = stream;
                            webcamElem.addEventListener( "loadeddata", resolve, false );
                        },
                    error => reject());
                }
                else {
                    console.warn("Failed to set up the webcam, make sure it is operating correctly.")
                    reject();
                }
            });
        }



        let webcam = null;

        (async () => {
            await setupWebcam();
        })();
            </script>
        </body>
    </body>
</html>
